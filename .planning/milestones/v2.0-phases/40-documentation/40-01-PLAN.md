---
phase: 40-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - manual/chapters/05-products.typ
  - manual/chapters/06-partitions.typ
  - manual/chapters/07-theta.typ
autonomous: true
requirements: [DOC-01]

must_haves:
  truths:
    - "Chapter 05 shows Garvan-canonical signatures for all 7 existing product functions plus 5 new entries (JAC, theta, jac2prod, jac2series, qs2jaccombo)"
    - "Chapter 06 shows numbpart as canonical name (not partition_count) with numbpart(n,m) variant documented"
    - "Chapter 07 includes a general theta(z, q, T) entry alongside existing theta2/3/4"
  artifacts:
    - path: "manual/chapters/05-products.typ"
      provides: "Garvan-canonical product function reference with 12 entries total"
      contains: "aqprod(a, q, n)"
    - path: "manual/chapters/06-partitions.typ"
      provides: "Partition function reference with numbpart as canonical"
      contains: "numbpart"
    - path: "manual/chapters/07-theta.typ"
      provides: "Theta function reference with general theta entry"
      contains: "theta(z, q, T)"
  key_links:
    - from: "manual/chapters/05-products.typ"
      to: "crates/qsym-cli/src/help.rs"
      via: "signature consistency"
      pattern: "aqprod\\(a, q"
    - from: "manual/chapters/06-partitions.typ"
      to: "crates/qsym-cli/src/help.rs"
      via: "signature consistency"
      pattern: "numbpart"
---

<objective>
Update manual chapters 05 (Products), 06 (Partitions), and 07 (Theta Functions) to reflect v2.0 Maple-compatible signatures, add new function entries, and ensure all documentation matches the help.rs canonical forms.

Purpose: These three chapters cover 19 functions (7 products + 5 new Jacobi/theta + 7 partitions) that need either signature replacement or entirely new entries. Per user decision, legacy signatures are replaced entirely with Garvan-canonical forms, new functions slot into existing categories (no separate v2.0 section), and formal math definitions are textbook-reference level.

Output: Three updated .typ files with Garvan-canonical signatures, new func-entry blocks for JAC/theta/jac2prod/jac2series/qs2jaccombo, numbpart as canonical partition_count replacement, and general theta entry.
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/40-documentation/40-CONTEXT.md
@.planning/phases/40-documentation/40-RESEARCH.md
@manual/chapters/05-products.typ
@manual/chapters/06-partitions.typ
@manual/chapters/07-theta.typ
@manual/template.typ
@crates/qsym-cli/src/help.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update chapter 05 (Products) signatures + add Jacobi Product section</name>
  <files>manual/chapters/05-products.typ</files>
  <action>
Replace ALL 7 existing product function signatures with Garvan-canonical forms. For each function, update: signature, description, params table, examples, and edge-cases. The help.rs entries are the authoritative source for signatures.

Specific signature replacements (match help.rs exactly):
- aqprod: `aqprod(a, q, n)` or `aqprod(a, q, infinity, T)` -- a is a q-monomial, q is the variable, n is count or infinity. Rewrite description to describe the new calling convention. Update math-def to reflect that a is passed directly as a q-monomial (e.g., q^2), not as integer triples. Update params: (a, q-monomial), (q, Variable), (n, Integer or infinity), (T, Integer truncation, for infinity form). Update examples to use Garvan forms: `aqprod(q^2, q, 5)`, `aqprod(q, q, infinity, 10)`.
- qbin: `qbin(q, m, n)` -- q is variable, m is lower, n is upper. Swap parameter order from old (n,k,order) to new (q,m,n). Update examples: `qbin(q, 2, 4)`.
- etaq: `etaq(q, delta, T)` or `etaq(q, [deltas], T)` -- q is variable, delta is base spacing, T is truncation. Also add multi-delta list form. Update examples: `etaq(q, 1, 10)`, `etaq(q, [1,2,3], 20)`. Note: t parameter is gone (always 1 in Garvan convention).
- jacprod: `jacprod(a, b, q, T)` -- now takes explicit q and T. Update examples: `jacprod(1, 5, q, 20)`.
- tripleprod: `tripleprod(z, q, T)` -- z is a q-monomial. Update examples: `tripleprod(q, q, 20)`.
- quinprod: `quinprod(z, q, T)` -- z is a q-monomial. Update examples: `quinprod(q, q, 20)`.
- winquist: `winquist(a, b, q, T)` -- a,b are q-monomials (not 6 integer-triple params). Update examples: `winquist(q, q^2, q, 10)`.

Then ADD a new subsection `== Jacobi Product Algebra` at the end of chapter 05 with 4 new func-entry blocks (theta goes in chapter 07 per its domain):
- JAC(a, b): Create Jacobi product factor (q^a;q^b)_inf. Math def: JAC(a,b) = (q^a; q^b)_inf. Note: JacobiProduct values support *, /, ^ operations. Example: `JAC(1,5) * JAC(4,5)`.
- jac2prod(JP, q, T): Convert JacobiProduct to explicit product notation. Prints and returns. Example: `jac2prod(JAC(1,5), q, 20)`.
- jac2series(JP, q, T): Convert JacobiProduct to truncated q-series. Example: `jac2series(JAC(1,5) * JAC(4,5), q, 20)`.
- qs2jaccombo(f, q, T): Decompose q-series into linear combination of Jacobi products. Example: `qs2jaccombo(etaq(q, 1, 30), q, 30)`.

Update the chapter intro text: change "seven product functions" to "twelve product functions" (7 original + 5 Jacobi algebra). Remove reference to "order parameter" as the universal truncation parameter name since Garvan form uses T.

Cross-reference Garvan worksheets where applicable per user decision (e.g., "As in Garvan's qseries package, the first argument is a q-monomial").
  </action>
  <verify>Read the file and verify: (1) all 7 original functions show Garvan signatures, (2) 5 new Jacobi entries exist, (3) no legacy integer-triple signatures remain, (4) all signatures match help.rs exactly.</verify>
  <done>Chapter 05 has 12 func-entry blocks, all with Garvan-canonical signatures matching help.rs, new Jacobi Product Algebra subsection with JAC/jac2prod/jac2series/qs2jaccombo entries including formal math definitions and worked examples.</done>
</task>

<task type="auto">
  <name>Task 2: Update chapter 06 (Partitions) numbpart + update chapter 07 (Theta) with general theta</name>
  <files>manual/chapters/06-partitions.typ, manual/chapters/07-theta.typ</files>
  <action>
**Chapter 06 (Partitions):**
Replace the partition_count entry entirely with numbpart as canonical:
- name: "numbpart" (was "partition_count")
- signature: "numbpart(n) or numbpart(n, m)" -- matching help.rs
- Description: Compute p(n), or with two args p(n,m) = partitions of n with largest part at most m
- Update index entries: change #index[partition count] to #index[numbpart]
- Update examples: `numbpart(5)` -> 7, `numbpart(100)` -> 190569292, `numbpart(200)` -> 3972999029388
- Add example for 2-arg form: `numbpart(10, 3)` showing bounded partition count
- Edge cases: mention partition_count remains as an alias
- Update all "related:" fields in other entries in this chapter that reference "partition_count" to say "numbpart"
- In the chapter intro text, change "one that returns a single integer $p(n)$" remains fine but ensure numbpart is the name used

**Chapter 07 (Theta):**
Add a new func-entry for the general theta function BEFORE the existing theta2/3/4 entries:
- name: "theta"
- signature: "theta(z, q, T)"
- Description: Compute the general theta series sum(z^i * q^(i^2), i=-T..T). z can be numeric (integer/rational) or a q-monomial like q^2.
- Math-def: theta(z, q, T) = sum_{i=-T}^{T} z^i * q^{i^2}. This is a finite sum (not truncated), returning an exact polynomial in q.
- Params: z (Integer, Rational, or q-monomial), q (Variable), T (Integer, summation bound)
- Examples: `theta(1, q, 5)` -> 2*q^25 + 2*q^16 + 2*q^9 + 2*q^4 + 2*q + 1 (matching help.rs output pattern)
- Edge cases: When z=1 this approaches theta3(q) as T->infinity. When z is an unassigned symbol, a warning is printed.
- Related: theta2, theta3, theta4

Update chapter 07 intro to mention "four theta functions" (was three) and note the general theta series alongside the three Jacobi specializations.
  </action>
  <verify>Read both files and verify: (1) chapter 06 uses numbpart everywhere (no partition_count as canonical), (2) numbpart(n,m) variant is documented, (3) chapter 07 has theta(z,q,T) entry, (4) all signatures match help.rs.</verify>
  <done>Chapter 06 shows numbpart as canonical with numbpart(n,m) variant. Chapter 07 has 4 theta function entries (general theta + theta2/3/4) with formal math definitions.</done>
</task>

</tasks>

<verification>
- All signatures in chapters 05, 06, 07 match help.rs canonical forms exactly
- No legacy integer-triple signatures remain in any of these chapters
- New functions (JAC, theta, jac2prod, jac2series, qs2jaccombo) all have complete func-entry blocks with math-def, params, examples, edge-cases, related
- numbpart is used as the canonical name throughout chapter 06
- Index entries use new function names
</verification>

<success_criteria>
- Chapters 05, 06, 07 contain 12 + 7 + 4 = 23 total func-entry blocks
- Every signature matches the corresponding help.rs entry
- All new functions have textbook-quality formal math definitions per user decision
- Cross-references to Garvan's Maple worksheets appear where applicable per user decision
</success_criteria>

<output>
After completion, create `.planning/phases/40-documentation/40-01-SUMMARY.md`
</output>
