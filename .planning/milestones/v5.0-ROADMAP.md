# Milestone v5.0: Maximum Maple Compatibility

**Status:** SHIPPED 2026-02-22
**Phases:** 52-56
**Total Plans:** 9

## Overview

Close remaining Maple language and function gaps -- fix the polynomial division hang, add while-loops, lists as first-class values, Maple built-in functions (coeff, add, seq, nops, op, map, sort, etc.), and Unicode paste resilience so researchers can run more Maple code without modification.

## Phases

### Phase 52: Bug Fix & Language Extensions
**Goal**: Researchers can run for-loops with polynomial division and use while-loops, print(), and pasted Unicode without errors
**Depends on**: Phase 51 (v4.0 complete)
**Requirements**: BUG-01, LANG-01, LANG-03, LANG-04
**Success Criteria** (what must be TRUE):
  1. `1/aqprod(q,q,5)` returns a series result without hanging, and `for n from 1 to 5 do q^n/aqprod(q,q,n) od` completes in bounded time
  2. `i:=0: while i<10 do i:=i+1 od: i;` evaluates to 10, and while-loops work with all comparison operators
  3. Pasting text containing Unicode math operators parses correctly instead of producing errors
  4. `print(expr)` inside a for-loop or procedure displays each intermediate value as it executes
**Plans**: 3 plans
Plans:
- [x] 52-01-PLAN.md -- Fix POLYNOMIAL_ORDER division hang, Unicode normalization, print() function
- [x] 52-02-PLAN.md -- While-loop parsing, evaluation, REPL support, and help
- [x] 52-03-PLAN.md -- Gap closure: is_truthy Symbol handling, ? prefix help dispatch

### Phase 53: Lists & List Operations
**Goal**: Researchers can create, display, index, and manipulate lists as first-class values using Maple syntax
**Depends on**: Phase 52
**Requirements**: LANG-02, LIST-01, LIST-02, LIST-03, LIST-04
**Plans**: 2 plans
Plans:
- [x] 53-01-PLAN.md -- AstNode::Index parser refactor, list indexing, indexed assignment with backward compat
- [x] 53-02-PLAN.md -- nops, op, map, sort dispatch, help entries, tab completion

### Phase 54: Series & Utility Functions
**Goal**: Researchers can extract series coefficients, decompose rational expressions, and use standard Maple utility functions
**Depends on**: Phase 52
**Requirements**: SERIES-01, SERIES-02, SERIES-03, UTIL-01, UTIL-02, UTIL-03, UTIL-04
**Plans**: 1 plan
Plans:
- [x] 54-01-PLAN.md -- coeff, degree, numer, denom, modp, mods, type, evalb, cat dispatch + help + tests

### Phase 55: Iteration with Range Syntax
**Goal**: Researchers can use Maple-style add/mul/seq with `i=a..b` range expressions for summation, products, and sequence generation
**Depends on**: Phase 53 (seq returns lists), Phase 54
**Requirements**: ITER-01, ITER-02, ITER-03
**Plans**: 1 plan
Plans:
- [x] 55-01-PLAN.md -- Token::DotDot, AstNode::Range, parser infix, eval special-case add/mul/seq, help, completion

### Phase 56: Documentation
**Goal**: All v5.0 additions are documented with help entries, tab completion, and a PDF manual chapter
**Depends on**: Phase 55
**Requirements**: DOC-01, DOC-02
**Plans**: 2 plans
Plans:
- [x] 56-01-PLAN.md -- Help entries for print/anames/restart, general_help() update, tab completion for print
- [x] 56-02-PLAN.md -- PDF manual v5.0 chapter, v4.0 stale content fix

---

## Milestone Summary

**Key Decisions:**
- 52-01: Fix division hang in eval_div (CLI layer) not core arithmetic::invert()
- 52-01: Unicode normalization before tokenization (string contents also normalized)
- 52-01: print() returns last value (not NULL like Maple)
- 52-02: while and for share the same od-depth counter in REPL is_incomplete
- 52-02: Safety limit set at 1,000,000 iterations
- 53-01: 1-indexed Maple convention; L[0] is out-of-range error
- 53-02: nops on FPS counts nonzero terms directly (sparse storage)
- 53-02: op on series returns [exponent, coefficient] list
- 54-01: coeff returns Integer when denom==1, Rational otherwise
- 54-01: modp/mods use ((a%p)+p)%p for correct negative handling
- 55-01: DotDot binding power (10,10): tighter than = (9,10), looser than + (11,12)
- 55-01: Empty ranges return mathematical identity (0 for add, 1 for mul, [] for seq)
- 56-01: print added to canonical_function_names but NOT to ALL_FUNCTION_NAMES

**Issues Resolved:**
- Polynomial division hang on POLYNOMIAL_ORDER sentinel values
- Unicode paste failures from PDFs/webpages
- Missing help entries for print, anames, restart
- Stale v4.0 manual claiming while loops unsupported

**Technical Debt Incurred:**
- Pre-existing Windows test (err_05_read_nonexistent_shows_file_not_found) fails due to double-quote passing
- print absent from ALL_FUNCTION_NAMES (by design, minor "Did you mean?" gap)
- Stale comment "90 functions" in eval.rs ALL_FUNCTION_NAMES

---

_For current project status, see .planning/ROADMAP.md_
