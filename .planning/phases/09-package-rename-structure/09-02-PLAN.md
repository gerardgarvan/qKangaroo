---
phase: 09-package-rename-structure
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - PROJECT.md
autonomous: true

must_haves:
  truths:
    - "import q_kangaroo succeeds in a Python session after maturin develop"
    - "All 9 Python integration tests pass with the new q_kangaroo import name"
    - "The compiled shared library is named _q_kangaroo (with underscore prefix) and loads correctly"
    - "import qsymbolic fails with ModuleNotFoundError (old name fully removed)"
    - "No references to the old name qsymbolic remain in any non-planning source file"
  artifacts:
    - path: "PROJECT.md"
      provides: "Top-level project documentation with updated package name references"
      contains: "q_kangaroo"
  key_links:
    - from: "crates/qsym-python/python/q_kangaroo/__init__.py"
      to: "_q_kangaroo native module"
      via: "from q_kangaroo._q_kangaroo import"
      pattern: "from q_kangaroo._q_kangaroo import"
    - from: "crates/qsym-python/tests/test_integration.py"
      to: "crates/qsym-python/python/q_kangaroo/__init__.py"
      via: "from q_kangaroo import"
      pattern: "from q_kangaroo import"
---

<objective>
Rebuild the Python package with the new name, run all 9 Python integration tests, verify the old name is dead, and update PROJECT.md references.

Purpose: Proves the full Python import chain works end-to-end with the new name (REN-01 through REN-05), and cleans up the last documentation references.
Output: Python tests passing under q_kangaroo, PROJECT.md updated, phase success criteria fully met.
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-package-rename-structure/09-RESEARCH.md
@.planning/phases/09-package-rename-structure/09-01-SUMMARY.md
@PROJECT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild Python package and verify full import chain</name>
  <files></files>
  <action>
Clean out the old package and rebuild with the new name. This is the critical end-to-end verification that the triple-match rule holds at runtime, not just in source text.

Step 1: Uninstall old package:
```bash
pip uninstall qsymbolic -y 2>/dev/null || true
```

Step 2: Clean ALL __pycache__ directories to prevent stale bytecode:
```bash
find crates/qsym-python -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
```

Step 3: Rebuild with maturin:
```bash
export PATH="/c/mingw64-gcc/mingw64/bin:/c/cygwin64/bin:/c/Users/Owner/.cargo/bin:$PATH"
export PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1
cd crates/qsym-python && maturin develop
```

Step 4: Verify the new import works:
```bash
python -c "import q_kangaroo; print(q_kangaroo.__version__)"
```
Expected output: `0.1.0`

Step 5: Verify the OLD import fails:
```bash
python -c "import qsymbolic" 2>&1 | grep -q "ModuleNotFoundError" && echo "OLD NAME CORRECTLY REMOVED" || echo "FAIL: old name still importable"
```

Step 6: Verify the native module name:
```bash
python -c "import q_kangaroo._q_kangaroo; print('Native module loaded')"
```

If maturin develop fails, check:
- PYO3_PYTHON env var points to Python 3.14
- PATH includes MinGW and cargo
- The triple-match: Cargo.toml [lib] name == pyproject.toml module-name suffix == lib.rs #[pymodule] fn name (all must be `_q_kangaroo`)
  </action>
  <verify>
1. `python -c "import q_kangaroo; print(q_kangaroo.__version__)"` prints `0.1.0`
2. `python -c "import qsymbolic"` raises ModuleNotFoundError
3. `python -c "import q_kangaroo._q_kangaroo"` succeeds
  </verify>
  <done>`import q_kangaroo` succeeds, `import qsymbolic` fails, native module _q_kangaroo loads correctly.</done>
</task>

<task type="auto">
  <name>Task 2: Run all 9 Python integration tests and update PROJECT.md</name>
  <files>PROJECT.md</files>
  <action>
Part A: Run the full Python integration test suite:
```bash
cd crates/qsym-python && python -m pytest tests/test_integration.py -v
```
All 9 tests must pass:
- test_euler_identity
- test_jacobi_triple_product
- test_findlincombo_identity
- test_prodmake_roundtrip
- test_batch_parameter_scan
- test_single_generate
- test_symbols_and_expressions
- test_distinct_odd_euler_identity
- test_hypergeometric_identity_verification

Part B: Update PROJECT.md (top-level, NOT .planning/PROJECT.md) to replace the 3 remaining `qsymbolic` references:
- Line 64: `Python API  (qsymbolic)` -> `Python API  (q_kangaroo)`
- Line 507: `from qsymbolic import *` -> `from q_kangaroo import *`
- Line 610: `qsymbolic/` -> `q_kangaroo/`

Part C: Final sweep -- verify no `qsymbolic` remains in any non-planning source file:
```bash
grep -r "qsymbolic" --include="*.py" --include="*.rs" --include="*.toml" . | grep -v ".planning/" | grep -v ".git/"
```
The only matches should be in PROJECT.md if any (which we just fixed). If this returns matches, fix them.

Also check the top-level PROJECT.md specifically:
```bash
grep "qsymbolic" PROJECT.md
```
Should return zero matches after the edit.
  </action>
  <verify>
1. `python -m pytest tests/test_integration.py -v` shows 9 passed, 0 failed
2. `grep "qsymbolic" PROJECT.md` returns no matches
3. `grep -r "qsymbolic" --include="*.py" --include="*.rs" --include="*.toml" . | grep -v ".planning/" | grep -v ".git/"` returns no matches
  </verify>
  <done>All 9 Python integration tests pass with `from q_kangaroo import`. PROJECT.md updated. Zero occurrences of "qsymbolic" remain in any source file outside of .planning/ historical records.</done>
</task>

</tasks>

<verification>
Phase 9 success criteria (from ROADMAP.md):
1. `import q_kangaroo` succeeds in a Python session after `maturin develop` -- VERIFIED by Task 1
2. All 578 Rust tests pass with `cargo test` after the rename -- VERIFIED by Plan 09-01 Task 2
3. All 9 Python integration tests pass with the new `q_kangaroo` import name -- VERIFIED by Task 2
4. The compiled shared library is named `_q_kangaroo` (with underscore prefix) and loads correctly -- VERIFIED by Task 1
5. No references to the old name `qsymbolic` remain in source files, configs, or test code -- VERIFIED by Task 2 final sweep
</verification>

<success_criteria>
- `import q_kangaroo` works and returns version 0.1.0
- `import qsymbolic` fails with ModuleNotFoundError
- All 9 Python integration tests pass
- PROJECT.md contains zero references to "qsymbolic"
- No non-planning source file in the repo contains "qsymbolic"
- All 5 REN requirements (REN-01 through REN-05) are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/09-package-rename-structure/09-02-SUMMARY.md`
</output>
