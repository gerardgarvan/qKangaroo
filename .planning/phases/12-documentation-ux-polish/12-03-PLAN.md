---
phase: 12-documentation-ux-polish
plan: 03
type: execute
wave: 2
depends_on: ["12-01", "12-02"]
files_modified:
  - docs/conf.py
  - docs/index.rst
  - docs/installation.rst
  - docs/quickstart.rst
  - docs/mathematical_notation.rst
  - docs/api/index.rst
  - docs/api/session.rst
  - docs/api/expr.rst
  - docs/api/series.rst
  - docs/api/pochhammer.rst
  - docs/api/products.rst
  - docs/api/theta.rst
  - docs/api/partitions.rst
  - docs/api/analysis.rst
  - docs/api/relations.rst
  - docs/api/hypergeometric.rst
  - docs/api/identity.rst
  - docs/api/mock_theta.rst
  - docs/requirements.txt
autonomous: true

must_haves:
  truths:
    - "sphinx-build -b html docs docs/_build/html succeeds without errors"
    - "API reference pages exist for all 10 functional groups plus 3 classes"
    - "Getting-started guide walks through basic q-series computation"
    - "Mathematical notation renders via MathJax in the built HTML"
  artifacts:
    - path: "docs/conf.py"
      provides: "Sphinx configuration with autodoc, napoleon, mathjax, furo theme"
      contains: "sphinx.ext.autodoc"
    - path: "docs/index.rst"
      provides: "Landing page with toctree"
      contains: "toctree"
    - path: "docs/quickstart.rst"
      provides: "Getting-started guide"
      contains: "Quick Start"
    - path: "docs/api/index.rst"
      provides: "API reference overview page"
      contains: "toctree"
    - path: "docs/requirements.txt"
      provides: "Documentation build dependencies"
      contains: "sphinx"
  key_links:
    - from: "docs/api/products.rst"
      to: "q_kangaroo.etaq"
      via: "autofunction directive"
      pattern: "autofunction.*q_kangaroo\\.etaq"
    - from: "docs/conf.py"
      to: "q_kangaroo"
      via: "autodoc imports the live module"
      pattern: "autodoc"
    - from: "docs/index.rst"
      to: "docs/api/index.rst"
      via: "toctree includes api/index"
      pattern: "api/index"
---

<objective>
Create the complete Sphinx documentation site scaffold with API reference pages for all 73 functions organized by functional group, a getting-started guide, installation page, and mathematical notation reference.

Purpose: Satisfies DOC-02 (Sphinx documentation site), DOC-03 (API reference for all 73 functions), DOC-04 (getting-started guide), DOC-07 (LaTeX renders in docs). The site uses Furo theme, autodoc + napoleon for API docs from the live module's docstrings, and MathJax for LaTeX rendering.

Output: Complete docs/ directory with Sphinx conf.py, 13 API reference RST pages, guides, and requirements.txt. Locally buildable.
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-documentation-ux-polish/12-RESEARCH.md
@.planning/phases/12-documentation-ux-polish/12-01-SUMMARY.md
@.planning/phases/12-documentation-ux-polish/12-02-SUMMARY.md
@crates/qsym-python/python/q_kangaroo/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Sphinx scaffold with conf.py and all RST pages</name>
  <files>
    docs/conf.py
    docs/index.rst
    docs/installation.rst
    docs/quickstart.rst
    docs/mathematical_notation.rst
    docs/api/index.rst
    docs/api/session.rst
    docs/api/expr.rst
    docs/api/series.rst
    docs/api/pochhammer.rst
    docs/api/products.rst
    docs/api/theta.rst
    docs/api/partitions.rst
    docs/api/analysis.rst
    docs/api/relations.rst
    docs/api/hypergeometric.rst
    docs/api/identity.rst
    docs/api/mock_theta.rst
    docs/requirements.txt
  </files>
  <action>
Create the `docs/` directory at the project root (C:/cygwin64/home/Owner/Kangaroo/docs/).

**docs/requirements.txt:**
```
sphinx>=8.2
furo>=2024.8
sphinx-math-dollar>=1.2.1
sphinx-copybutton>=0.5
nbsphinx>=0.9
sphinx-autodoc-typehints>=2.0
```

**docs/conf.py:**
```python
project = "q-Kangaroo"
copyright = "2025, q-Kangaroo Contributors"
author = "q-Kangaroo Contributors"

extensions = [
    "sphinx.ext.autodoc",
    "sphinx.ext.autosummary",
    "sphinx.ext.napoleon",
    "sphinx.ext.mathjax",
    "sphinx.ext.intersphinx",
    "sphinx_math_dollar",
    "sphinx_copybutton",
    "sphinx_autodoc_typehints",
    "nbsphinx",
]

html_theme = "furo"

# Napoleon: NumPy-style docstrings
napoleon_google_docstring = False
napoleon_numpy_docstring = True
napoleon_use_param = True
napoleon_use_rtype = True
napoleon_preprocess_types = True

# MathJax for LaTeX rendering
mathjax3_config = {
    "tex": {
        "inlineMath": [["\\(", "\\)"]],
        "displayMath": [["\\[", "\\]"]],
    }
}

# Intersphinx links to Python stdlib
intersphinx_mapping = {
    "python": ("https://docs.python.org/3", None),
}

# Autodoc settings
autodoc_member_order = "bysource"
autodoc_typehints = "description"

# nbsphinx: pre-executed notebooks only
nbsphinx_execute = "never"

# Exclude patterns
exclude_patterns = ["_build", "Thumbs.db", ".DS_Store"]
```

**docs/index.rst:**
Landing page with project overview and toctree. Structure:
```rst
q-Kangaroo Documentation
========================

Brief description: symbolic computation engine for q-series...

.. toctree::
   :maxdepth: 2
   :caption: User Guide

   installation
   quickstart
   mathematical_notation

.. toctree::
   :maxdepth: 2
   :caption: API Reference

   api/index

.. toctree::
   :maxdepth: 2
   :caption: Examples

   examples/index
```
The examples/index toctree will be empty initially (added in Plan 04). Add a note: "Example notebooks coming soon" or use conditional `.. toctree::` that skips if empty.

Actually, omit the Examples toctree from index.rst for now -- Plan 04 will add it.

**docs/installation.rst:**
- pip install q-kangaroo
- From source instructions (clone, maturin develop)
- System requirements (Python 3.9+, GMP auto-bundled in wheels)
- Verify installation command

**docs/quickstart.rst:**
A narrative getting-started guide (DOC-04):
1. Create a session
2. Compute Euler's function with etaq
3. Count partitions with partition_count
4. Discover partition congruences with findcong
5. Work with theta functions
6. Use the convenience helper get_default_session()

Use `.. code-block:: python` with expected output shown. Include inline math using `$...$` syntax for formulas.

**docs/mathematical_notation.rst:**
Reference page mapping q-Kangaroo function names to standard mathematical notation:
- $(a;q)_n$ notation for aqprod
- $[n \choose k]_q$ for qbin
- $(q^b;q^t)_\infty$ for etaq
- $\theta_2, \theta_3, \theta_4$ for theta functions
- $_r\phi_s$ for phi (DLMF 17.4.1)
- $_r\psi_s$ for psi
- Brief note on the BTreeMap/truncation model

**docs/api/index.rst:**
Overview page with toctree linking to all 13 API pages:
```rst
API Reference
=============

.. toctree::
   :maxdepth: 1

   session
   expr
   series
   pochhammer
   products
   theta
   partitions
   analysis
   relations
   hypergeometric
   identity
   mock_theta
```

**docs/api/session.rst:**
```rst
QSession
========

.. autoclass:: q_kangaroo.QSession
   :members:
   :undoc-members:
```

**docs/api/expr.rst:**
```rst
QExpr
=====

.. autoclass:: q_kangaroo.QExpr
   :members:
   :undoc-members:
```

**docs/api/series.rst:**
```rst
QSeries
=======

.. autoclass:: q_kangaroo.QSeries
   :members:
   :undoc-members:
```

**docs/api/pochhammer.rst:**
Group 1: q-Pochhammer and q-Binomial. Brief intro, then:
```rst
.. autofunction:: q_kangaroo.aqprod
.. autofunction:: q_kangaroo.qbin
```

**docs/api/products.rst:**
Group 2: Named Products. Brief mathematical intro, then autofunction for etaq, jacprod, tripleprod, quinprod, winquist.

**docs/api/theta.rst:**
Group 3: Theta Functions. Brief intro on Jacobi theta functions, then autofunction for theta2, theta3, theta4.

**docs/api/partitions.rst:**
Group 4: Partition Functions. Brief intro on integer partitions, then autofunction for partition_count, partition_gf, distinct_parts_gf, odd_parts_gf, bounded_parts_gf, rank_gf, crank_gf.

**docs/api/analysis.rst:**
Group 5: Series Analysis. Brief intro on Andrews' algorithm and q-factoring, then autofunction for qfactor, sift, qdegree, lqdegree, prodmake, etamake, jacprodmake, mprodmake, qetamake.

**docs/api/relations.rst:**
Groups 6-7: Relation Discovery. Brief intro on linear algebra over q-series, then autofunction for all 12 relation functions: findlincombo, findhom, findpoly, findcong, findnonhom, findhomcombo, findnonhomcombo, findlincombomodp, findhommodp, findhomcombomodp, findmaxind, findprod.

**docs/api/hypergeometric.rst:**
Group 8: Hypergeometric Series. Brief intro on basic hypergeometric series, DLMF reference, then autofunction for phi, psi, try_summation, heine1, heine2, heine3.

**docs/api/identity.rst:**
Group 9: Identity Proving. Brief intro on eta-quotient identities and the valence formula, then autofunction for prove_eta_id, search_identities.

**docs/api/mock_theta.rst:**
Group 10: Mock Theta, Appell-Lerch, Bailey. Organize with subsection headers:
- Third-Order Mock Theta Functions (7 functions)
- Fifth-Order Mock Theta Functions (10 functions)
- Seventh-Order Mock Theta Functions (3 functions)
- Appell-Lerch Sums (3 functions)
- Bailey Chain Machinery (4 functions)
Each with autofunction directives.

Each API page should have a brief (2-4 sentence) mathematical introduction before the autofunction directives, using `$...$` for inline math.
  </action>
  <verify>
Install docs dependencies and build:
```bash
cd C:/cygwin64/home/Owner/Kangaroo
pip install -r docs/requirements.txt
sphinx-build -b html docs docs/_build/html -W 2>&1 | tail -20
```
The `-W` flag turns warnings into errors. If autodoc warnings about missing module occur, verify the native module is installed:
```bash
cd crates/qsym-python && PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1 maturin develop --release
cd C:/cygwin64/home/Owner/Kangaroo && sphinx-build -b html docs docs/_build/html -W
```
Check key output files exist:
```bash
ls docs/_build/html/index.html
ls docs/_build/html/quickstart.html
ls docs/_build/html/api/index.html
ls docs/_build/html/api/products.html
```

Note: If sphinx-build has issues with the `-W` flag on the first pass (e.g., nbsphinx warnings about missing example notebooks), remove `-W` and verify the core build succeeds. Warnings about missing examples/index are expected and will be fixed in Plan 04.
  </verify>
  <done>Sphinx documentation site builds successfully with Furo theme, autodoc pulling docstrings from the live module, MathJax rendering LaTeX, and 13 API reference pages covering all 73 functions organized by functional group. quickstart.rst provides a narrative getting-started guide.</done>
</task>

</tasks>

<verification>
- `sphinx-build -b html docs docs/_build/html` completes without errors
- docs/_build/html/index.html exists and links to all sections
- docs/_build/html/api/products.html contains etaq documentation
- docs/_build/html/quickstart.html has working code examples
- LaTeX formulas render in built HTML (visible in browser)
</verification>

<success_criteria>
- DOC-02 partially satisfied: Sphinx site builds locally (GitHub Pages deployment in Plan 04)
- DOC-03 satisfied: API reference covers all 73 functions in 10 topic pages + 3 class pages
- DOC-04 satisfied: quickstart.rst walks through basic computation
- DOC-07 satisfied: LaTeX renders via MathJax + sphinx-math-dollar
</success_criteria>

<output>
After completion, create `.planning/phases/12-documentation-ux-polish/12-03-SUMMARY.md`
</output>
