---
phase: 32-pdf-reference-manual
plan: 03
type: execute
wave: 2
depends_on: [32-01]
files_modified:
  - manual/chapters/09-relations.typ
  - manual/chapters/10-hypergeometric.typ
autonomous: true
requirements: [DOC-01]

must_haves:
  truths:
    - "All 12 relation-discovery functions have complete entries with algorithm descriptions"
    - "All 9 hypergeometric functions have complete entries with formal series definitions"
    - "Every function entry includes signature, description, parameters, 2-3 REPL examples, edge cases, and related functions"
  artifacts:
    - path: "manual/chapters/09-relations.typ"
      provides: "12 function entries: findlincombo through findpoly"
      contains: "func-entry"
    - path: "manual/chapters/10-hypergeometric.typ"
      provides: "9 function entries: phi through find_transformation_chain"
      contains: "func-entry"
  key_links:
    - from: "manual/chapters/09-relations.typ"
      to: "manual/template.typ"
      via: "func-entry template calls"
      pattern: "#func-entry"
    - from: "manual/chapters/10-hypergeometric.typ"
      to: "manual/template.typ"
      via: "func-entry template calls"
      pattern: "#func-entry"
---

<objective>
Write function reference chapters 9-10 covering Relation Discovery (12) and Hypergeometric Series (9) -- 21 functions total.

Purpose: Document the relation-finding tools (linear algebra over Q) and the basic/bilateral hypergeometric series functions with transformation identities.

Output: manual/chapters/09-relations.typ, 10-hypergeometric.typ
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/32-pdf-reference-manual/32-RESEARCH.md
@.planning/phases/32-pdf-reference-manual/32-01-SUMMARY.md
@crates/qsym-cli/src/help.rs
@crates/qsym-cli/src/eval.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write Relations chapter (09)</name>
  <files>manual/chapters/09-relations.typ</files>
  <action>
**chapters/09-relations.typ** -- "Relation Discovery" chapter (12 functions):

Chapter introduction (1 paragraph): These functions use Gaussian elimination over Q (or Z/pZ) to discover algebraic relations among q-series. They are the primary research tools for finding new identities. All functions operate on truncated series and use the `topshift` parameter to control how many leading coefficients to skip (useful when series have known leading terms that should not participate in the relation search).

Organize the 12 functions into 3 subsections:

**Subsection: Linear Combinations**

**findlincombo** (main workhorse):
- Signature: `findlincombo(target, [candidates], topshift)`
- Description: Find rational coefficients $c_i$ such that $"target" = sum c_i dot "candidates"[i]$. Uses exact arithmetic over Q via RREF.
- Math: informal (utility/algorithm)
- Parameters: target (Series), candidates (List of Series), topshift (Integer: skip leading coefficients)
- Examples: Show finding that partition_gf = odd_parts_gf via `findlincombo(partition_gf(30), [odd_parts_gf(30), distinct_parts_gf(30)], 0)` -- should return coefficients showing partition_gf equals odd_parts_gf (Euler's theorem)
- Edge cases: Returns null if no combination exists; candidates must be non-empty list
- Related: findhomcombo, findnonhomcombo, findlincombomodp

**findhomcombo**:
- Signature: `findhomcombo(target, [candidates], degree, topshift)`
- Finds homogeneous polynomial combination of given degree
- Example: degree-2 combination

**findnonhomcombo**:
- Includes all monomials from degree 0 through degree d

**findlincombomodp**:
- Arithmetic mod prime p using Fermat inverse
- Use when exact rational arithmetic is too expensive

**findhomcombomodp**:
- Combines monomial generation with modular arithmetic

**Subsection: Relation Finding (among series)**

**findhom**:
- Finds homogeneous polynomial relation of given degree among the series in the input list
- Returns null space of coefficient matrix
- Example: `findhom([theta3(50)^2, theta2(50)^2, theta4(50)^2], 1, 0)` to find Jacobi's theta identity

**findnonhom**:
- Includes constant and lower-degree terms

**findhommodp**:
- Modular arithmetic variant

**findmaxind**:
- Finds maximally independent subset via Gaussian elimination
- Returns indices of pivot columns
- Useful for determining dimension of a space of modular forms

**Subsection: Specialized Searches**

**findprod**:
- Brute-force search over exponent combinations: tests $product "series"[i]^(e_i)$ for $|e_i| <= "max_coeff"$
- Example: `findprod([etaq(1,1,30), etaq(2,1,30)], 3, 2)` to find product identity among eta functions

**findcong**:
- Finds partition-type congruences by checking whether sifted subsequences vanish modulo specified moduli
- Example: `findcong(partition_gf(200), [5, 7, 11])` to discover Ramanujan's congruences
- Index: "Ramanujan congruences", "partition congruences"

**findpoly**:
- Finds polynomial relation P(x,y)=0 between two series
- Example: `findpoly(theta3(50)^4, theta2(50)^4 + theta4(50)^4, 1, 1, 0)` relating theta functions

For ALL: use func-entry template, signatures from eval.rs, examples from help.rs, index entries for function names and mathematical concepts (Gaussian elimination, RREF, modular arithmetic, congruence).
  </action>
  <verify>
Verify 09-relations.typ contains func-entry calls for all 12 functions: findlincombo, findhomcombo, findnonhomcombo, findlincombomodp, findhomcombomodp, findhom, findnonhom, findhommodp, findmaxind, findprod, findcong, findpoly.
  </verify>
  <done>
Relations chapter complete with 12 function entries organized into 3 subsections (linear combinations, relation finding, specialized searches).
  </done>
</task>

<task type="auto">
  <name>Task 2: Write Hypergeometric chapter (10)</name>
  <files>manual/chapters/10-hypergeometric.typ</files>
  <action>
**chapters/10-hypergeometric.typ** -- "Basic Hypergeometric Series" chapter (9 functions):

Chapter introduction (1-2 paragraphs): The basic hypergeometric series ${}_r phi_s$ and bilateral ${}_r psi_s$ are fundamental objects in q-series theory. Define the general ${}_r phi_s$ formula:

$attach(, tl: r) phi_s mat(a_1, a_2, ..., a_r; b_1, b_2, ..., b_s; q, z) = sum_(n=0)^oo frac((a_1;q)_n (a_2;q)_n dots.c (a_r;q)_n, (b_1;q)_n (b_2;q)_n dots.c (b_s;q)_n (q;q)_n) [(-1)^n q^(binom(n,2))]^(1+s-r) z^n$

Explain the parameter encoding: upper and lower parameters are each specified as lists of `(num, den, pow)` triples representing $("num"/"den") q^"pow"$.

**phi** (basic hypergeometric):
- Signature: `phi(upper_list, lower_list, z_num, z_den, z_pow, order)`
- Math definition: the formal ${}_r phi_s$ series (display equation above)
- Parameters: upper_list (List of (num,den,pow) triples), lower_list (List of triples), z_num/z_den/z_pow (Integer: encodes $z = (z_"num"\/z_"den") q^(z_"pow")$), order (Integer)
- Examples: `phi([(1,1,1)], [(1,1,2)], 1, 1, 1, 10)` for a 1_phi_0
- Edge cases: upper_list or lower_list can be empty; check for division by zero when lower param has $(q;q)_0 = 0$
- Related: psi, try_summation, heine1-3

**psi** (bilateral hypergeometric):
- Math: ${}_r psi_s$ sums over all integers $n in ZZ$
- Related: phi

**try_summation** (closed-form search):
- Attempts q-Gauss, q-Vandermonde, q-Saalschutz, q-Kummer, q-Dixon formulas
- Returns closed-form product or null if no formula applies
- List the 5 classical summation formulas by name
- Related: phi, q_gosper

**Subsection: Heine Transformations**

Brief mathematical intro: Heine's three classical transformations of ${}_2 phi_1$ series.

**heine1**: First transformation -- transforms $2 phi_1(a,b;c;q,z)$ into a product times another $2 phi_1$
**heine2**: Second transformation
**heine3**: Third transformation -- transforms into a ratio of infinite products times a $2 phi_1$

All three share the same signature pattern. Explain that input and output are both $(upper, lower, z)$ triples.

**Subsection: Advanced Transformations**

**sears_transform**: Sears' balanced 4_phi_3 transformation. Note: requires balanced condition.
**watson_transform**: Watson's 8_phi_7 to 4_phi_3 reduction. Note: requires very-well-poised condition.

**find_transformation_chain**:
- BFS search for chain of Heine/Sears/Watson transformations connecting source to target
- 12 parameters (source series + target series + max_depth + order)
- Example: finding a 2-step transformation path
- Related: heine1, heine2, heine3, sears_transform, watson_transform

Index entries: "basic hypergeometric series", "bilateral series", "Heine transformation", "Sears transformation", "Watson transformation", "q-Gauss sum", "q-Vandermonde", "q-Saalschutz", "summation formula".

For ALL: use func-entry template, signatures from eval.rs, examples from help.rs.
  </action>
  <verify>
Verify 10-hypergeometric.typ contains func-entry calls for all 9 functions: phi, psi, try_summation, heine1, heine2, heine3, sears_transform, watson_transform, find_transformation_chain.
  </verify>
  <done>
Hypergeometric chapter complete with 9 function entries, formal series definition, and subsections for Heine and advanced transformations.
  </done>
</task>

</tasks>

<verification>
- All 21 functions in Groups 5-6 have func-entry entries
- Hypergeometric chapter includes the formal r_phi_s definition equation
- Signatures match eval.rs get_signature() exactly
- Examples match help.rs FUNC_HELP data
- No Maple equivalents in individual entries (migration table only)
- Index entries for all function names and mathematical concepts
</verification>

<success_criteria>
- 2 chapter files with 21 total function entries
- Relations chapter organized into 3 logical subsections
- Hypergeometric chapter includes formal mathematical definitions
- All entries have complete func-entry fields
</success_criteria>

<output>
After completion, create `.planning/phases/32-pdf-reference-manual/32-03-SUMMARY.md`
</output>
