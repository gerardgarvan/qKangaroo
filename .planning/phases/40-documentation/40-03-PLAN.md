---
phase: 40-documentation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - manual/chapters/00-title.typ
  - manual/chapters/01-quick-start.typ
  - manual/chapters/03-cli-usage.typ
  - manual/chapters/04-expression-language.typ
  - crates/qsym-cli/src/repl.rs
  - README.md
autonomous: true
requirements: [DOC-02, DOC-03, DOC-04, DOC-06]

must_haves:
  truths:
    - "Function count references throughout the manual say 89 (not 81)"
    - "partition_count references in non-reference chapters replaced with numbpart"
    - "Tab completion includes lqdegree0, checkmult, checkprod (91 total names)"
    - "README function count updated"
    - "Help system confirmed already up to date (DOC-02 verified, no code changes needed)"
  artifacts:
    - path: "manual/chapters/00-title.typ"
      provides: "Title page with correct function count"
      contains: "89"
    - path: "manual/chapters/01-quick-start.typ"
      provides: "Quick start with numbpart and updated help example"
      contains: "numbpart"
    - path: "manual/chapters/04-expression-language.typ"
      provides: "Expression language chapter with updated function groups"
      contains: "89"
    - path: "crates/qsym-cli/src/repl.rs"
      provides: "Tab completion with all v2.0 function names"
      contains: "checkmult"
    - path: "README.md"
      provides: "README with correct function count"
      contains: "89"
  key_links:
    - from: "crates/qsym-cli/src/repl.rs"
      to: "crates/qsym-cli/src/eval.rs"
      via: "canonical_function_names must match ALL_FUNCTION_NAMES"
      pattern: "lqdegree0.*checkmult.*checkprod"
---

<objective>
Fix function count references across the manual, update partition_count to numbpart in non-reference chapters, add 3 missing functions to tab completion, update README, and verify help system needs no changes (DOC-02).

Purpose: Multiple places in the manual say "81 built-in functions" but the actual count is now 89. Several chapters reference partition_count as the canonical name but it's now numbpart. Three functions (lqdegree0, checkmult, checkprod) are missing from tab completion. This plan addresses all these peripheral fixes plus README and Python API verification.

Output: 6 updated files with consistent function counts, canonical names, and complete tab completion.
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/40-documentation/40-CONTEXT.md
@.planning/phases/40-documentation/40-RESEARCH.md
@manual/chapters/00-title.typ
@manual/chapters/01-quick-start.typ
@manual/chapters/03-cli-usage.typ
@manual/chapters/04-expression-language.typ
@crates/qsym-cli/src/repl.rs
@crates/qsym-cli/src/help.rs
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix function counts and names in manual chapters 00, 01, 03, 04</name>
  <files>manual/chapters/00-title.typ, manual/chapters/01-quick-start.typ, manual/chapters/03-cli-usage.typ, manual/chapters/04-expression-language.typ</files>
  <action>
**Chapter 00 (Title page):**
- Line 21: Change "all 81 built-in functions" to "all 89 built-in functions"

**Chapter 01 (Quick Start):**
- Line 38: Change `partition_count(100)` to `numbpart(100)` in the #repl example (keep same output "190569292")
- Line 84: Change "all 81 built-in functions" to "all 89 built-in functions"
- Lines 87-95: Update the help example to show Garvan-canonical signature for aqprod. Replace the help output block:
  Old: `aqprod(coeff_num, coeff_den, power, n_or_infinity, order)` with description about integer triple
  New: `aqprod(a, q, n) or aqprod(a, q, infinity, T)` with description matching help.rs: "Compute the q-Pochhammer product (a;q)_n where a is a q-monomial, q is the variable, and n is a non-negative integer."
  Update example in help block: `aqprod(q^2, q, 5)` -> show polynomial output matching help.rs

**Chapter 03 (CLI Usage):**
- Line 129: Change "all 81 functions" to "all 89 functions" in the help command description

**Chapter 04 (Expression Language):**
- Line 130: Change "81 built-in functions organized into 8 groups" to "89 built-in functions organized into 10 groups"
- Lines 132-139: Update the function group listing to include new groups and correct counts:
  * Products (12): add JAC, theta (general, in Products for this listing), jac2prod, jac2series, qs2jaccombo -- OR keep Products (7) and add a Jacobi Products (5) line. Better: follow the help.rs categorization which has Products (7) + Jacobi Products (5) as separate groups. Actually the listing should match help.rs general_help() exactly. So use:
  * Products (7): `aqprod`, `qbin`, `etaq`, `jacprod`, `tripleprod`, `quinprod`, `winquist`
  * Partitions (7): `numbpart` (was `partition_count`), rest unchanged
  * Theta Functions (4): add `theta` to the list (was 3, now 4)
  * Jacobi Products (4): NEW LINE -- `JAC`, `jac2prod`, `jac2series`, `qs2jaccombo`
  * Series Analysis (12): add `lqdegree0`, `checkmult`, `checkprod` (was 9)
  * Relations (12): unchanged
  * Hypergeometric (9): unchanged
  * Mock Theta & Bailey (27): unchanged
  * Identity Proving (7): unchanged
  That's 7+7+4+4+12+12+9+27+7 = 89 and 9 groups. But we also have anames/restart (session functions). help.rs has 10 categories including Commands. In the manual we can say "89 built-in functions organized into 9 categories" since Commands is separate. Or count theta as part of Products. Let's match help.rs: 9 function categories (Products, Partitions, Theta, Jacobi Products, Analysis, Relations, Hypergeometric, Mock Theta, Identity Proving) = "89 built-in functions organized into 9 categories". Actually theta has 4 items but help says "Theta Functions:" with theta, theta2, theta3, theta4. Let's use 10 groups (adding Jacobi Products as 10th). Wait -- help.rs already lists exactly 9 function groups + Commands. Let's say "89 built-in functions organized into 9 groups" and list them matching help.rs.
- Line 133: Change `partition_count` to `numbpart` in the Partitions list
- In the Value Types table, change "partition_count" references to "numbpart" (line 195 area)
  </action>
  <verify>Read all 4 files and search for "81" -- should find zero instances. Search for "partition_count" in chapters 00-04 -- should find zero instances (except where it's used as a value type description for the generic function, but the name should say numbpart). Verify function count is 89 everywhere.</verify>
  <done>All four manual chapters updated: function count consistently says 89, all partition_count references replaced with numbpart, function group listing includes Jacobi Products and updated counts, help example shows Garvan signature.</done>
</task>

<task type="auto">
  <name>Task 2: Fix tab completion + update README + verify help/Python</name>
  <files>crates/qsym-cli/src/repl.rs, README.md</files>
  <action>
**Tab completion (repl.rs):**
Add 3 missing function names to canonical_function_names(). In the Group 4: Analysis section (around line 64), add `lqdegree0`, `checkmult`, `checkprod` to match eval.rs ALL_FUNCTION_NAMES. The current Analysis group is:
```
"sift", "qdegree", "lqdegree", "qfactor",
"prodmake", "etamake", "jacprodmake", "mprodmake", "qetamake",
```
Change to:
```
"sift", "qdegree", "lqdegree", "lqdegree0", "qfactor",
"prodmake", "etamake", "jacprodmake", "mprodmake", "qetamake",
"checkmult", "checkprod",
```

Update the function count in the doc comment on line 18: "All 88 canonical" -> "All 91 canonical"
Update line 52 doc comment: "All 88 canonical" -> "All 91 canonical"
Update the test on line 218: `assert_eq!(names.len(), 88, ...)` -> `assert_eq!(names.len(), 91, ...)`
Also update the complete_theta test (line 251) -- it expects 4 candidates for "theta" prefix (theta, theta2, theta3, theta4). This should still be 4 (unchanged since theta was already added in v2.0).

**README.md:**
- Line 56: Change "all 81 functions" to "all 89 functions" in the Documentation section link text

**DOC-02 verification (help.rs):**
The research confirmed help.rs is already fully updated with 89 Garvan-canonical entries. The general_help() has the Jacobi Products category. function_help("partition_count") redirects to numbpart. DOC-02 requires NO code changes -- just verify and note in the summary.

**DOC-04 verification (Python API):**
The research confirmed Python API uses its own calling conventions (QSession first arg) unaffected by v2.0 REPL changes. The function is still called `partition_count` in Python (it's the Python API name, not a REPL alias). Per Claude's discretion: targeted review only, no changes needed. Note in summary that Python API docstrings are accurate for their own interface.
  </action>
  <verify>
Run tests to verify tab completion works:
```
export PATH="/c/mingw64-gcc/mingw64/bin:/c/cygwin64/bin:/c/Users/Owner/.cargo/bin:$PATH"
cargo test -p qsym-cli canonical_function_count -- --exact
cargo test -p qsym-cli complete_theta -- --exact
cargo test -p qsym-cli no_duplicate_function_names -- --exact
```
Read README.md and verify "81" no longer appears.
  </verify>
  <done>Tab completion includes all 91 canonical function names (88 + lqdegree0 + checkmult + checkprod), tests pass. README says 89 functions. DOC-02 confirmed complete (help.rs already updated). DOC-04 confirmed no changes needed (Python API unaffected).</done>
</task>

</tasks>

<verification>
- `cargo test -p qsym-cli` passes with 0 failures (tab completion count test updated)
- No instance of "81" as a function count in any manual chapter or README
- No instance of "partition_count" as canonical name in manual chapters 00-04
- Tab completion list has exactly 91 entries including lqdegree0, checkmult, checkprod
- help.rs confirmed already correct (89 entries, Garvan signatures, Jacobi Products category)
</verification>

<success_criteria>
- All 6 files updated with consistent information
- cargo test -p qsym-cli passes (tab completion count = 91)
- Function count = 89 everywhere in manual/README
- numbpart used as canonical name in all non-reference chapters
- DOC-02 satisfied (help system verified complete)
- DOC-03 satisfied (tab completion fixed)
- DOC-04 satisfied (Python API verified)
- DOC-06 satisfied (README updated)
</success_criteria>

<output>
After completion, create `.planning/phases/40-documentation/40-03-SUMMARY.md`
</output>
