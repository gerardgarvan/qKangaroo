---
phase: 56-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - crates/qsym-cli/src/help.rs
  - crates/qsym-cli/src/repl.rs
autonomous: true
requirements:
  - DOC-01

must_haves:
  truths:
    - "?print shows help text describing print(expr, ...) with an example"
    - "?anames shows help text describing anames() with an example"
    - "?restart shows help text describing restart() with an example"
    - "Tab-completing 'pri' in the REPL offers 'print('"
    - "Typing 'help' in the REPL lists print, anames, and restart in their categories"
  artifacts:
    - path: "crates/qsym-cli/src/help.rs"
      provides: "FuncHelp entries for print, anames, restart + general_help() updates"
      contains: "name: \"print\""
    - path: "crates/qsym-cli/src/repl.rs"
      provides: "print added to canonical_function_names"
      contains: "\"print\""
  key_links:
    - from: "crates/qsym-cli/src/help.rs"
      to: "crates/qsym-cli/src/repl.rs"
      via: "canonical_function_names drives which names have help"
      pattern: "canonical_function_names"
---

<objective>
Add help entries and tab completion for all v5.0 functions/keywords that are still missing.

Purpose: Phases 52-55 already added help entries for most v5.0 functions during implementation. Three functions remain without help entries (print, anames, restart) and one function (print) is missing from tab completion. This plan fills those gaps and updates all test count assertions.

Output: Updated help.rs and repl.rs with complete help coverage for all dispatchable functions.
</objective>

<execution_context>
@.planning/phases/56-documentation/56-RESEARCH.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@crates/qsym-cli/src/help.rs
@crates/qsym-cli/src/repl.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add FuncHelp entries and general_help() listings for print, anames, restart</name>
  <files>crates/qsym-cli/src/help.rs</files>
  <action>
  Add three new FuncHelp entries to the FUNC_HELP array in help.rs. Place them in a new section after the existing groups:

  ```rust
  // Group X: Variable Management & Output (3)
  FuncHelp {
      name: "print",
      signature: "print(expr, ...)",
      description: "Display one or more expressions, each on its own line.\n  Useful for showing intermediate results inside loops and procedures.\n  Returns the last argument's value (not NULL, unlike Maple's print).",
      example: "q> for k from 1 to 3 do print(k^2) od",
      example_output: "1\n4\n9",
  },
  FuncHelp {
      name: "anames",
      signature: "anames()",
      description: "Return a list of all currently assigned variable names.\n  The names are returned as a sorted list of strings.",
      example: "q> x := 1: y := 2: anames()",
      example_output: "[\"x\", \"y\"]",
  },
  FuncHelp {
      name: "restart",
      signature: "restart()",
      description: "Clear all variables, procedures, and reset the session.\n  Returns the string \"Restart.\"  Equivalent to the clear command.",
      example: "q> x := 42: restart()",
      example_output: "Restart.",
  },
  ```

  Update general_help() string to add print, anames, and restart:
  - Add `print` to the existing "Scripting:" category, after the `->` line:
    `  print          - display intermediate values: print(expr, ...)`
  - Add a new "Variable Management:" category between "Scripting:" and "Commands:":
    ```
    Variable Management:
      anames         - list all assigned variable names
      restart        - clear all variables and reset the session
    ```

  Update test assertions:
  - `func_help_count_matches_canonical` test: change 115 to 118
  - `every_canonical_function_has_help_entry` test: add "print", "anames", "restart" to the hardcoded canonical vec AND update the count assertion from 115 to 118
  - Update the FUNC_HELP doc comment from "All 115 function help entries" to "All 118 function help entries"

  IMPORTANT: Do NOT touch eval.rs. print is special-cased before dispatch (line 1194) and must NOT be added to ALL_FUNCTION_NAMES. anames and restart are already in ALL_FUNCTION_NAMES.
  </action>
  <verify>
  Run: `export PATH="/c/mingw64-gcc/mingw64/bin:/c/cygwin64/bin:/c/Users/Owner/.cargo/bin:$PATH" && cd /c/cygwin64/home/Owner/Kangaroo && cargo test -p qsym-cli -- help 2>&1 | tail -20`

  All help-related tests pass, including:
  - `func_help_count_matches_canonical` (now expects 118)
  - `every_canonical_function_has_help_entry` (includes print, anames, restart)
  - `general_help_contains_scripting_category` (includes print line)
  </verify>
  <done>
  ?print, ?anames, and ?restart all return help text. The `help` command listing includes print under Scripting and anames/restart under Variable Management. All count assertions match.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add print to canonical_function_names for tab completion</name>
  <files>crates/qsym-cli/src/repl.rs</files>
  <action>
  Add "print" to canonical_function_names() in repl.rs. Place it in a new comment group or alongside the Variable Management group:

  ```rust
  // Group X: Output (1)
  "print",
  ```

  Update test assertion:
  - `canonical_function_count` test: change 117 to 118

  Note: anames and restart are ALREADY in canonical_function_names (Group 9, line 104). Only print needs to be added.
  </action>
  <verify>
  Run: `export PATH="/c/mingw64-gcc/mingw64/bin:/c/cygwin64/bin:/c/Users/Owner/.cargo/bin:$PATH" && cd /c/cygwin64/home/Owner/Kangaroo && cargo test -p qsym-cli -- repl 2>&1 | tail -20`

  All repl-related tests pass, including:
  - `canonical_function_count` (now expects 118)
  - `no_duplicate_function_names`
  </verify>
  <done>
  Typing "pri" followed by Tab in the REPL offers "print(" as a completion candidate. The canonical_function_count test passes with 118.
  </done>
</task>

</tasks>

<verification>
Run the full CLI test suite to confirm no regressions:

```bash
export PATH="/c/mingw64-gcc/mingw64/bin:/c/cygwin64/bin:/c/Users/Owner/.cargo/bin:$PATH"
cd /c/cygwin64/home/Owner/Kangaroo
cargo test -p qsym-cli 2>&1 | tail -5
```

All tests pass (expect 720+ tests).
</verification>

<success_criteria>
- FUNC_HELP has exactly 118 entries (was 115)
- canonical_function_names has exactly 118 entries (was 117)
- general_help() includes print in Scripting, anames and restart in Variable Management
- All qsym-cli tests pass with no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/56-documentation/56-01-SUMMARY.md`
</output>
